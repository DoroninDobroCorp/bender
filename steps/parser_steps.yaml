# Parser Steps Configuration
# 6 шагов создания парсера

steps:
  - id: 1
    name: "Анализ и планирование"
    prompt_template: |
      Проанализируй целевой сайт и создай план парсера.
      
      URL сайта: {target_url}
      Что нужно парсить: {parse_target}
      
      Твои задачи:
      1. Изучи структуру сайта (HTML, API endpoints если есть)
      2. Определи какие данные доступны и как их получить
      3. Создай файл PARSER_PLAN.md с планом:
         - Какие страницы/endpoints парсить
         - Какие данные извлекать
         - Какие библиотеки использовать (requests, playwright, etc)
         - Возможные проблемы (антибот, капча, rate limits)
      
      Критерии выполнения:
      - [ ] Создан файл PARSER_PLAN.md
      - [ ] План содержит конкретные URL/endpoints
      - [ ] Выбраны библиотеки для парсинга
      - [ ] Описаны возможные проблемы
      
      Когда закончишь - скажи что сделал или что всё уже готово.
    completion_criteria:
      - "Создан файл PARSER_PLAN.md"
      - "План содержит конкретные URL/endpoints"
      - "Выбраны библиотеки для парсинга"

  - id: 2
    name: "Базовая структура проекта"
    prompt_template: |
      Создай базовую структуру проекта парсера.
      
      На основе PARSER_PLAN.md создай:
      1. Структуру директорий
      2. requirements.txt с зависимостями
      3. Базовые файлы:
         - config.py (настройки, URL, credentials placeholder)
         - models.py (dataclasses/pydantic для данных)
         - __init__.py файлы
      
      Критерии выполнения:
      - [ ] Создана структура директорий
      - [ ] requirements.txt с нужными библиотеками
      - [ ] config.py с настройками
      - [ ] models.py с моделями данных
      
      Когда закончишь - скажи что сделал или что всё уже готово.
    completion_criteria:
      - "Создана структура директорий"
      - "requirements.txt с зависимостями"
      - "config.py с настройками"
      - "models.py с моделями данных"

  - id: 3
    name: "Реализация парсера"
    prompt_template: |
      Реализуй основную логику парсера.
      
      На основе PARSER_PLAN.md и созданной структуры:
      1. Реализуй функции/классы для парсинга
      2. Обработка HTTP запросов (с retry, headers, cookies)
      3. Извлечение данных (BeautifulSoup, lxml, regex)
      4. Обработка ошибок и edge cases
      
      Критерии выполнения:
      - [ ] Реализованы функции парсинга
      - [ ] Есть обработка ошибок
      - [ ] Код следует плану из PARSER_PLAN.md
      
      Когда закончишь - скажи что сделал или что всё уже готово.
    completion_criteria:
      - "Реализованы функции парсинга"
      - "Есть обработка ошибок"
      - "Код следует плану"

  - id: 4
    name: "Хранение данных"
    prompt_template: |
      Реализуй сохранение и хранение данных.
      
      Задачи:
      1. Выбери формат хранения (JSON, CSV, SQLite, PostgreSQL)
      2. Реализуй функции сохранения
      3. Добавь дедупликацию (не сохранять дубли)
      4. Добавь инкрементальное обновление (если применимо)
      
      Критерии выполнения:
      - [ ] Реализовано сохранение данных
      - [ ] Есть дедупликация
      - [ ] Данные сохраняются корректно
      
      Когда закончишь - скажи что сделал или что всё уже готово.
    completion_criteria:
      - "Реализовано сохранение данных"
      - "Есть дедупликация"
      - "Данные сохраняются корректно"

  - id: 5
    name: "CLI и запуск"
    prompt_template: |
      Создай удобный интерфейс запуска парсера.
      
      Задачи:
      1. CLI с argparse или click
      2. Команды: run, status, export
      3. Конфигурация через .env или аргументы
      4. Логирование (в файл и консоль)
      5. Progress bar для длительных операций
      
      Критерии выполнения:
      - [ ] CLI работает
      - [ ] Есть логирование
      - [ ] Можно запустить парсер командой
      
      Когда закончишь - скажи что сделал или что всё уже готово.
    completion_criteria:
      - "CLI работает"
      - "Есть логирование"
      - "Парсер запускается командой"

  - id: 6
    name: "Тестирование и документация"
    prompt_template: |
      Протестируй парсер и создай документацию.
      
      Задачи:
      1. Запусти парсер и проверь что данные собираются
      2. Исправь найденные баги
      3. Создай README.md:
         - Описание что парсит
         - Установка и настройка
         - Примеры использования
         - Формат выходных данных
      4. Добавь примеры выходных данных
      
      Критерии выполнения:
      - [ ] Парсер работает без ошибок
      - [ ] README.md создан
      - [ ] Есть примеры данных
      
      Когда закончишь - скажи что сделал или что всё уже готово.
    completion_criteria:
      - "Парсер работает без ошибок"
      - "README.md создан"
      - "Есть примеры данных"
